<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'none'; img-src {{cspSource}} https:; style-src {{cspSource}} 'unsafe-inline'; script-src {{cspSource}};"
    />
    <title>Flutter Config Manager</title>
    <style>
      :root {
        color-scheme: dark;
        --bg-primary: #0d1117;
        --bg-secondary: #161b22;
        --bg-tertiary: #21262d;
        --bg-elevated: #1c2128;
        --border-default: #30363d;
        --border-muted: #21262d;
        --text-primary: #e6edf3;
        --text-secondary: #8b949e;
        --text-muted: #6e7681;
        --android-accent: #3ddc84;
        --android-accent-dim: rgba(61, 220, 132, 0.15);
        --android-glow: rgba(61, 220, 132, 0.4);
        --ios-accent: #0a84ff;
        --ios-accent-dim: rgba(10, 132, 255, 0.15);
        --ios-glow: rgba(10, 132, 255, 0.4);
        --macos-accent: #bf5af2;
        --macos-accent-dim: rgba(191, 90, 242, 0.15);
        --macos-glow: rgba(191, 90, 242, 0.4);
        --danger: #f85149;
        --danger-dim: rgba(248, 81, 73, 0.15);
        --success: #3ddc84;
        --warning: #d29922;
        --radius-sm: 6px;
        --radius-md: 10px;
        --radius-lg: 14px;
        --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);
        --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);
        --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.5);
        --transition-fast: 0.15s ease;
        --transition-normal: 0.25s ease;
      }

      /* Light theme overrides (opt-in) */
      :root[data-theme="light"] {
        color-scheme: light;
        --bg-primary: #ffffff;
        --bg-secondary: #f6f8fa;
        --bg-tertiary: #ffffff;
        --bg-elevated: #f3f4f6;
        --border-default: #e1e4e8;
        --border-muted: #e9eef3;
        --text-primary: #0b1117;
        --text-secondary: #57606a;
        --text-muted: #6b7280;
        --android-accent: #0f9d58;
        --android-accent-dim: rgba(15, 157, 88, 0.12);
        --android-glow: rgba(15, 157, 88, 0.15);
        --ios-accent: #006eed;
        --ios-accent-dim: rgba(0, 110, 237, 0.12);
        --ios-glow: rgba(0, 110, 237, 0.15);
        --macos-accent: #7a3fe3;
        --macos-accent-dim: rgba(122, 63, 227, 0.12);
        --macos-glow: rgba(122, 63, 227, 0.15);
        --danger: #c92a2a;
        --danger-dim: rgba(201, 42, 42, 0.12);
        --success: #0f9d58;
        --warning: #b45309;
      }

      /* Remove hover/focus highlights on buttons */
      button:hover,
      button:focus,
      button:active {
        transform: none !important;
        box-shadow: none !important;
        outline: none !important;
      }

      * {
        box-sizing: border-box;
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        margin: 0;
        padding: 24px;
        background: var(--bg-primary);
        color: var(--text-primary);
        line-height: 1.5;
        min-height: 100vh;
        background-image:
          radial-gradient(
            ellipse 80% 50% at 50% -20%,
            rgba(61, 220, 132, 0.08),
            transparent
          ),
          radial-gradient(
            ellipse 60% 40% at 100% 100%,
            rgba(10, 132, 255, 0.06),
            transparent
          );
      }

      /* Header */
      .header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: 16px;
        padding: 16px 24px;
        border-bottom: 1px solid var(--border-default);
        position: sticky;
        top: 0;
        background: var(--bg-primary);
        z-index: 100;
        margin: -24px -24px 24px -24px;
        width: calc(100% + 48px);
      }

      .header-left {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .logo {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .logo-icon {
        width: 42px;
        height: 42px;
        background: linear-gradient(
          135deg,
          var(--android-accent),
          var(--ios-accent)
        );
        border-radius: var(--radius-md);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        box-shadow:
          0 4px 16px rgba(61, 220, 132, 0.25),
          0 4px 16px rgba(10, 132, 255, 0.25);
      }

      h1 {
        margin: 0;
        font-size: 1.5rem;
        font-weight: 700;
        letter-spacing: -0.02em;
        background: linear-gradient(
          135deg,
          var(--text-primary),
          var(--text-secondary)
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .header-right {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .platform-chips {
        display: flex;
        gap: 10px;
      }

      .chip {
        padding: 8px 14px;
        border-radius: 100px;
        font-size: 13px;
        font-weight: 600;
        font-family: "Consolas", "Monaco", monospace;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: var(--transition-fast);
      }

      .chip::before {
        content: "";
        width: 8px;
        height: 8px;
        border-radius: 50%;
      }

      .chip.android {
        background: var(--android-accent-dim);
        color: var(--android-accent);
        border: 1px solid rgba(61, 220, 132, 0.3);
      }

      .chip.android::before {
        background: var(--android-accent);
        box-shadow: 0 0 8px var(--android-glow);
      }

      .chip.ios {
        background: var(--ios-accent-dim);
        color: var(--ios-accent);
        border: 1px solid rgba(10, 132, 255, 0.3);
      }

      .chip.ios::before {
        background: var(--ios-accent);
        box-shadow: 0 0 8px var(--ios-glow);
      }

      .chip.macos {
        background: var(--macos-accent-dim);
        color: var(--macos-accent);
        border: 1px solid rgba(191, 90, 242, 0.3);
      }

      .chip.macos::before {
        background: var(--macos-accent);
        box-shadow: 0 0 8px var(--macos-glow);
      }

      /* Section */
      .section {
        margin-bottom: 32px;
      }

      .section-header {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 16px;
      }

      .section-header h2 {
        margin: 0;
        font-size: 1.1rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .section-header h2::before {
        content: "";
        width: 4px;
        height: 20px;
        border-radius: 2px;
      }

      .section.android .section-header h2::before {
        background: var(--android-accent);
        box-shadow: 0 0 12px var(--android-glow);
      }

      .section.ios .section-header h2::before {
        background: var(--ios-accent);
        box-shadow: 0 0 12px var(--ios-glow);
      }

      .section.macos .section-header h2::before {
        background: var(--macos-accent);
        box-shadow: 0 0 12px var(--macos-glow);
      }

      /* Toolbar */
      .toolbar {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        align-items: center;
        margin-bottom: 16px;
        padding: 14px;
        background: var(--bg-secondary);
        border: 1px solid var(--border-default);
        border-radius: var(--radius-lg);
      }

      .toolbar input,
      .toolbar select {
        padding: 10px 14px;
        font-size: 13px;
        font-family: inherit;
        border: 1px solid var(--border-default);
        border-radius: var(--radius-md);
        min-width: 220px;
        background: var(--bg-tertiary);
        color: var(--text-primary);
        transition: var(--transition-fast);
      }

      .toolbar input::placeholder {
        color: var(--text-muted);
      }

      .toolbar input:focus,
      .toolbar select:focus {
        outline: none;
        border-color: var(--android-accent);
        box-shadow: 0 0 0 3px var(--android-accent-dim);
      }

      .section.ios .toolbar input:focus,
      .section.ios .toolbar select:focus {
        border-color: var(--ios-accent);
        box-shadow: 0 0 0 3px var(--ios-accent-dim);
      }

      .section.macos .toolbar input:focus,
      .section.macos .toolbar select:focus {
        border-color: var(--macos-accent);
        box-shadow: 0 0 0 3px var(--macos-accent-dim);
      }

      .toolbar select {
        cursor: pointer;
        appearance: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%238b949e' d='M2 4l4 4 4-4'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 12px center;
        padding-right: 36px;
      }

      /* Buttons */
      button {
        font-family: inherit;
        font-size: 13px;
        font-weight: 600;
        padding: 10px 16px;
        border: none;
        border-radius: var(--radius-md);
        cursor: pointer;
        transition: var(--transition-fast);
        display: inline-flex;
        align-items: center;
        gap: 6px;
      }

      .btn-primary {
        background: var(--android-accent);
        color: var(--bg-primary);
        box-shadow: 0 2px 8px var(--android-glow);
      }

      .btn-primary:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 16px var(--android-glow);
      }

      .btn-primary.ios {
        background: var(--ios-accent);
        box-shadow: 0 2px 8px var(--ios-glow);
      }

      .btn-primary.ios:hover {
        box-shadow: 0 4px 16px var(--ios-glow);
      }

      .btn-secondary {
        background: var(--bg-tertiary);
        color: var(--text-primary);
        border: 1px solid var(--border-default);
      }

      .btn-secondary:hover {
        background: var(--bg-elevated);
        border-color: var(--text-muted);
      }

      .btn-save {
        background: linear-gradient(
          135deg,
          var(--android-accent),
          var(--ios-accent)
        );
        color: var(--bg-primary);
        font-weight: 700;
        padding: 12px 20px;
        box-shadow:
          0 4px 16px rgba(61, 220, 132, 0.2),
          0 4px 16px rgba(10, 132, 255, 0.2);
      }

      .btn-save:hover {
        transform: translateY(-1px);
        box-shadow:
          0 6px 24px rgba(61, 220, 132, 0.3),
          0 6px 24px rgba(10, 132, 255, 0.3);
      }

      button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none !important;
      }

      /* Table */
      .table-container {
        overflow-x: auto;
        border: 1px solid var(--border-default);
        border-radius: var(--radius-lg);
        background: var(--bg-secondary);
        box-shadow: var(--shadow-md);
      }

      table {
        width: 100%;
        border-collapse: collapse;
        min-width: 720px;
      }

      th,
      td {
        padding: 14px 16px;
        border-bottom: 1px solid var(--border-muted);
        text-align: left;
        vertical-align: middle;
        font-size: 13px;
      }

      th {
        cursor: pointer;
        background: var(--bg-tertiary);
        position: sticky;
        top: 0;
        z-index: 1;
        font-weight: 600;
        color: var(--text-secondary);
        text-transform: uppercase;
        font-size: 11px;
        letter-spacing: 0.05em;
        transition: var(--transition-fast);
      }

      th:hover {
        color: var(--text-primary);
        background: var(--bg-elevated);
      }

      th.sort-asc::after {
        content: " ‚Üë";
        color: var(--android-accent);
      }

      th.sort-desc::after {
        content: " ‚Üì";
        color: var(--android-accent);
      }

      tbody tr {
        transition: var(--transition-fast);
      }

      tbody tr:hover {
        background: var(--bg-tertiary);
      }

      tbody tr:last-child td {
        border-bottom: none;
      }

      td {
        color: var(--text-primary);
      }

      td span {
        font-family: "Consolas", "Monaco", monospace;
        font-size: 12px;
      }

      td input,
      td select {
        width: 100%;
        padding: 8px 10px;
        border: 1px solid var(--border-default);
        border-radius: var(--radius-sm);
        background: var(--bg-tertiary);
        color: var(--text-primary);
        font-size: 13px;
        font-family: inherit;
        transition: var(--transition-fast);
      }

      td input:focus,
      td select:focus {
        outline: none;
        border-color: var(--ios-accent);
        box-shadow: 0 0 0 2px var(--ios-accent-dim);
      }

      td textarea {
        width: 100%;
        min-height: 72px;
        padding: 8px 10px;
        border: 1px solid var(--border-default);
        border-radius: var(--radius-sm);
        background: var(--bg-tertiary);
        color: var(--text-primary);
        font-size: 13px;
        font-family: inherit;
        resize: vertical;
      }

      .empty-state {
        color: var(--text-muted);
        font-style: italic;
        padding: 32px 16px;
        text-align: center;
      }

      /* Toast Notifications */
      .toast-container {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 9999;
        display: flex;
        flex-direction: column-reverse;
        gap: 10px;
        pointer-events: none;
      }

      .toast {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 14px 18px;
        border-radius: var(--radius-md);
        background: var(--bg-secondary);
        border: 1px solid var(--border-default);
        box-shadow:
          var(--shadow-lg),
          0 0 40px rgba(0, 0, 0, 0.3);
        font-size: 14px;
        font-weight: 500;
        color: var(--text-primary);
        pointer-events: auto;
        animation: toastSlideIn 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        transform-origin: top right;
        max-width: 380px;
        backdrop-filter: blur(12px);
      }

      .toast.hiding {
        animation: toastSlideOut 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards;
      }

      @keyframes toastSlideIn {
        from {
          opacity: 0;
          transform: translateX(100%) scale(0.8);
        }
        to {
          opacity: 1;
          transform: translateX(0) scale(1);
        }
      }

      @keyframes toastSlideOut {
        from {
          opacity: 1;
          transform: translateX(0) scale(1);
        }
        to {
          opacity: 0;
          transform: translateX(100%) scale(0.8);
        }
      }

      .toast-icon {
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        font-size: 14px;
      }

      .toast.success {
        border-color: rgba(61, 220, 132, 0.4);
        background: linear-gradient(
          135deg,
          rgba(61, 220, 132, 0.15),
          var(--bg-secondary)
        );
      }

      .toast.success .toast-icon {
        background: var(--android-accent);
        color: var(--bg-primary);
        box-shadow: 0 0 20px var(--android-glow);
      }

      .toast.error {
        border-color: rgba(248, 81, 73, 0.4);
        background: linear-gradient(
          135deg,
          rgba(248, 81, 73, 0.15),
          var(--bg-secondary)
        );
      }

      .toast.error .toast-icon {
        background: var(--danger);
        color: white;
        box-shadow: 0 0 20px rgba(248, 81, 73, 0.4);
      }

      .toast.info {
        border-color: rgba(10, 132, 255, 0.4);
        background: linear-gradient(
          135deg,
          rgba(10, 132, 255, 0.15),
          var(--bg-secondary)
        );
      }

      .toast.info .toast-icon {
        background: var(--ios-accent);
        color: white;
        box-shadow: 0 0 20px var(--ios-glow);
      }

      .toast-content {
        flex: 1;
        line-height: 1.4;
      }

      .toast-close {
        background: none;
        border: none;
        color: var(--text-muted);
        cursor: pointer;
        padding: 4px;
        border-radius: 4px;
        transition: var(--transition-fast);
        font-size: 18px;
        line-height: 1;
      }

      .toast-close:hover {
        color: var(--text-primary);
        background: var(--bg-tertiary);
      }

      .toast-progress {
        position: absolute;
        bottom: 0;
        left: 0;
        height: 3px;
        border-radius: 0 0 var(--radius-md) var(--radius-md);
        animation: toastProgress linear forwards;
      }

      .toast.success .toast-progress {
        background: var(--android-accent);
      }

      .toast.error .toast-progress {
        background: var(--danger);
      }

      .toast.info .toast-progress {
        background: var(--ios-accent);
      }

      @keyframes toastProgress {
        from {
          width: 100%;
        }
        to {
          width: 0%;
        }
      }

      /* Services Section */
      .section.services {
        background: linear-gradient(
          180deg,
          var(--bg-secondary) 0%,
          rgba(139, 92, 246, 0.05) 100%
        );
        border-color: rgba(139, 92, 246, 0.3);
        border-radius: var(--radius-lg);
        box-shadow: 0 2px 12px rgba(139, 92, 246, 0.07);
        padding-top: 18px;
        padding-left: 18px;
        padding-right: 18px;
      }

      .section.services .section-header h2 {
        background: linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-size: 1.3rem;
      }

      .section.services .toolbar input {
        border-color: rgba(139, 92, 246, 0.3);
      }

      .section.services .toolbar input:focus {
        border-color: #8b5cf6;
        box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.15);
      }

      .section.services .btn-primary {
        background: linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%);
      }

      .section.services .btn-primary:hover {
        background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
      }

      .services-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 16px;
        padding: 16px 0;
      }

      .service-card {
        background: var(--bg-tertiary);
        border: 1px solid var(--border-default);
        border-radius: var(--radius-lg);
        padding: 20px;
        transition: var(--transition-fast);
      }

      .service-card:hover {
        border-color: rgba(139, 92, 246, 0.5);
        box-shadow: 0 4px 20px rgba(139, 92, 246, 0.1);
      }

      .service-card-header {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 16px;
        padding-bottom: 16px;
        border-bottom: 1px solid var(--border-default);
      }

      .service-card-icon {
        font-size: 24px;
        width: 48px;
        height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(139, 92, 246, 0.15);
        border-radius: var(--radius-md);
      }

      .service-card-title {
        font-weight: 600;
        font-size: 16px;
        color: var(--text-primary);
      }

      .service-card-status {
        font-size: 12px;
        color: #22c55e;
        margin-top: 4px;
        display: flex;
        align-items: center;
        gap: 4px;
      }

      .service-card-fields {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin-bottom: 16px;
      }

      .service-field {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 13px;
        padding: 10px 12px;
        background: var(--bg-secondary);
        border-radius: var(--radius-sm);
        border: 1px solid var(--border-default);
      }

      .service-field-label {
        color: var(--text-secondary);
        font-weight: 500;
      }

      .service-field-value {
        color: var(--text-primary);
        font-family: "Consolas", "Monaco", monospace;
        max-width: 180px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        background: rgba(139, 92, 246, 0.1);
        padding: 2px 8px;
        border-radius: var(--radius-sm);
      }

      .service-card-actions {
        display: flex;
        gap: 8px;
        padding-top: 12px;
        border-top: 1px solid var(--border-default);
      }

      .service-card-actions button {
        flex: 1;
        padding: 10px 16px;
        font-size: 13px;
        font-weight: 500;
      }

      .service-card-actions .edit-service-btn {
        background: rgba(139, 92, 246, 0.15);
        border-color: rgba(139, 92, 246, 0.3);
        color: #a78bfa;
      }

      .service-card-actions .edit-service-btn:hover {
        background: rgba(139, 92, 246, 0.25);
        border-color: rgba(139, 92, 246, 0.5);
      }

      .service-list {
        display: flex;
        flex-direction: column;
        gap: 8px;
        max-height: 400px;
        overflow-y: auto;
      }

      .service-list-item {
        display: flex;
        align-items: center;
        gap: 16px;
        padding: 16px;
        background: var(--bg-tertiary);
        border: 1px solid var(--border-default);
        border-radius: var(--radius-md);
        cursor: pointer;
        transition: var(--transition-fast);
      }

      .service-list-item:hover {
        border-color: rgba(139, 92, 246, 0.5);
        background: rgba(139, 92, 246, 0.1);
      }

      .service-list-item.disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .service-list-item .service-icon {
        font-size: 28px;
        width: 48px;
        height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(139, 92, 246, 0.15);
        border-radius: var(--radius-md);
      }

      .service-list-item .service-info {
        flex: 1;
      }

      .service-list-item .service-name {
        font-weight: 600;
        color: var(--text-primary);
      }

      .service-list-item .service-desc {
        font-size: 13px;
        color: var(--text-secondary);
        margin-top: 4px;
      }

      .service-modal .service-form {
        display: flex;
        flex-direction: column;
        gap: 16px;
      }

      .service-modal .form-group {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }

      .service-modal .form-group label {
        font-size: 12px;
        font-weight: 600;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .service-modal .form-group input {
        padding: 12px 14px;
        border: 1px solid var(--border-default);
        border-radius: var(--radius-md);
        background: var(--bg-tertiary);
        color: var(--text-primary);
        font-family: "Consolas", "Monaco", monospace;
        font-size: 14px;
      }

      .service-modal .form-group input:focus {
        outline: none;
        border-color: rgba(139, 92, 246, 0.5);
        box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
      }

      .empty-services {
        text-align: center;
        padding: 48px 20px;
        color: var(--text-muted);
        background: var(--bg-tertiary);
        border-radius: var(--radius-lg);
        border: 1px dashed var(--border-default);
      }

      .empty-services-icon {
        font-size: 48px;
        margin-bottom: 16px;
        opacity: 0.6;
      }

      .empty-services p {
        margin: 0;
        line-height: 1.5;
      }

      .empty-services p:first-of-type {
        font-size: 15px;
        color: var(--text-secondary);
        font-weight: 500;
      }

      /* Legacy status - hidden but kept for compatibility */
      .status {
        display: none !important;
      }

      /* Action Buttons */
      .equivalent-button {
        background: linear-gradient(
          135deg,
          rgba(61, 220, 132, 0.2),
          rgba(10, 132, 255, 0.2)
        );
        color: var(--text-primary);
        border: 1px solid rgba(61, 220, 132, 0.3);
        border-radius: var(--radius-sm);
        padding: 4px 10px;
        font-size: 11px;
        font-weight: 600;
        cursor: pointer;
        margin-left: 10px;
        transition: var(--transition-fast);
      }

      .equivalent-button:hover {
        background: linear-gradient(
          135deg,
          rgba(61, 220, 132, 0.3),
          rgba(10, 132, 255, 0.3)
        );
        border-color: var(--android-accent);
        transform: translateY(-1px);
      }

      .delete-button {
        background: var(--danger-dim);
        color: var(--danger);
        border: 1px solid rgba(248, 81, 73, 0.3);
        border-radius: var(--radius-sm);
        padding: 6px 12px;
        cursor: pointer;
        font-size: 12px;
        font-weight: 500;
        transition: var(--transition-fast);
      }

      .delete-button:hover {
        background: rgba(248, 81, 73, 0.25);
        border-color: var(--danger);
      }

      /* Modal */
      .modal-backdrop {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(4px);
        display: none;
        align-items: center;
        justify-content: center;
        padding: 16px;
        z-index: 1000;
      }

      .modal {
        background: var(--bg-secondary);
        color: var(--text-primary);
        border: 1px solid var(--border-default);
        border-radius: var(--radius-lg);
        max-width: 820px;
        width: 100%;
        padding: 24px;
        box-shadow: var(--shadow-lg);
        z-index: 1001;
        animation: modalSlideIn 0.2s ease;
      }

      @keyframes modalSlideIn {
        from {
          opacity: 0;
          transform: translateY(-20px) scale(0.95);
        }
        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }

      .modal h3 {
        margin: 0 0 16px;
        font-size: 1.1rem;
        font-weight: 600;
      }

      .modal input {
        width: 100%;
        padding: 12px 14px;
        border: 1px solid var(--border-default);
        border-radius: var(--radius-md);
        margin-bottom: 12px;
        background: var(--bg-tertiary);
        color: var(--text-primary);
        font-family: inherit;
        font-size: 14px;
        transition: var(--transition-fast);
      }

      .modal input::placeholder {
        color: var(--text-muted);
      }

      .modal input:focus {
        outline: none;
        border-color: var(--android-accent);
        box-shadow: 0 0 0 3px var(--android-accent-dim);
      }

      .modal-results {
        max-height: 280px;
        overflow-y: auto;
        border: 1px solid var(--border-default);
        border-radius: var(--radius-md);
        background: var(--bg-tertiary);
      }

      .modal-results::-webkit-scrollbar {
        width: 8px;
      }

      .modal-results::-webkit-scrollbar-track {
        background: var(--bg-tertiary);
      }

      .modal-results::-webkit-scrollbar-thumb {
        background: var(--border-default);
        border-radius: 4px;
      }

      .modal-item {
        padding: 12px 14px;
        border-bottom: 1px solid var(--border-muted);
        cursor: pointer;
        transition: var(--transition-fast);
      }

      .modal-item:last-child {
        border-bottom: none;
      }

      .modal-item:hover {
        background: var(--bg-elevated);
      }

      .modal-item.selected {
        background: var(--android-accent-dim);
        border-left: 3px solid var(--android-accent);
      }

      .modal-actions {
        display: flex;
        justify-content: flex-end;
        gap: 10px;
        margin-top: 20px;
        padding-top: 16px;
        border-top: 1px solid var(--border-muted);
      }

      /* Category Tabs */
      .category-tabs {
        display: flex;
        gap: 6px;
        flex-wrap: wrap;
        margin-bottom: 12px;
      }

      .category-tab {
        padding: 8px 14px;
        border: 1px solid var(--border-default);
        background: var(--bg-tertiary);
        color: var(--text-secondary);
        border-radius: 100px;
        cursor: pointer;
        font-size: 12px;
        font-weight: 500;
        transition: var(--transition-fast);
      }

      .category-tab:hover {
        background: var(--bg-elevated);
        color: var(--text-primary);
        border-color: var(--text-muted);
      }

      .category-tab.active {
        background: var(--android-accent);
        color: var(--bg-primary);
        border-color: var(--android-accent);
      }

      /* Cross-platform suggestion */
      .cross-platform-suggestion {
        display: flex;
        flex-direction: column;
        gap: 10px;
        padding: 12px;
        border: 1px solid var(--border-default);
        border-radius: var(--radius-md);
        margin-bottom: 8px;
        background: var(--bg-tertiary);
        transition: var(--transition-fast);
      }

      .cross-platform-suggestion:hover {
        border-color: var(--text-muted);
        background: var(--bg-elevated);
      }

      .cross-platform-suggestion input[type="checkbox"] {
        margin: 0;
        width: 18px;
        height: 18px;
        flex: 0 0 18px;
        accent-color: var(--android-accent);
        cursor: pointer;
      }

      .cross-platform-suggestion .suggestion-row {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .cross-platform-suggestion label {
        flex: 1;
        font-weight: 500;
        font-family: "Consolas", "Monaco", monospace;
        font-size: 12px;
        min-width: 0;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        cursor: pointer;
      }

      .equivalent-value-input {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid var(--border-default);
        border-radius: var(--radius-md);
        background: var(--bg-secondary);
        color: var(--text-primary);
        font-size: 13px;
        font-family: inherit;
      }

      .equivalent-value-input:focus {
        outline: none;
        border-color: var(--ios-accent);
        box-shadow: 0 0 0 2px var(--ios-accent-dim);
      }

      /* Responsive */
      @media (max-width: 700px) {
        body {
          padding: 16px;
        }

        .header {
          flex-direction: column;
          align-items: flex-start;
          margin: -16px -16px 16px -16px;
          width: calc(100% + 32px);
          padding: 12px 16px;
        }

        .toolbar {
          flex-direction: column;
          align-items: stretch;
        }

        .toolbar input,
        .toolbar select {
          width: 100%;
          min-width: unset;
        }

        .platform-chips {
          width: 100%;
        }

        .chip {
          flex: 1;
          justify-content: center;
        }
      }

      /* Scrollbar styling */
      ::-webkit-scrollbar {
        width: 10px;
        height: 10px;
      }

      ::-webkit-scrollbar-track {
        background: var(--bg-primary);
      }

      ::-webkit-scrollbar-thumb {
        background: var(--border-default);
        border-radius: 5px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: var(--text-muted);
      }
    </style>
  </head>

  <body>
    <header class="header">
      <div class="header-left">
        <div class="logo">
          <div class="logo-icon">‚öôÔ∏è</div>
          <h1>Flutter Config Manager</h1>
        </div>
      </div>
      <div class="header-right">
        <div class="platform-chips">
          <div id="androidCountChip" class="chip android">Android: 0</div>
          <div id="iosCountChip" class="chip ios">iOS: 0</div>
          <div id="macosCountChip" class="chip macos">macOS: 0</div>
        </div>
        <button id="refreshButton" type="button" class="btn-secondary">
          ‚Üª Refresh
        </button>
        <button id="syncPermissionsButton" type="button" class="btn-secondary">
          üîÑ Sync Equivalents
        </button>
        <button id="savePermissionsButton" type="button" class="btn-save">
          üíæ Save All Changes
        </button>
      </div>
    </header>

    <section id="androidSection" class="section android">
      <div class="section-header">
        <h2>Android Permissions</h2>
      </div>
      <div class="toolbar">
        <input
          type="text"
          id="permissionSearch"
          placeholder="Search permissions or descriptions..."
        />
        <select id="categoryFilter">
          <option value="">All categories</option>
        </select>
        <button
          id="addAndroidPermissionButton"
          type="button"
          class="btn-primary"
        >
          + Add Permission
        </button>
      </div>
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th data-column="permission">Permission</th>
              <th data-column="description">Description</th>
              <th data-column="constantValue">Constant Value</th>
              <th data-column="category">Category</th>
              <th data-column="apiLevel">API Level</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="androidPermissionTable"></tbody>
        </table>
      </div>
    </section>

    <!-- Toast Container for Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Hidden status for backwards compatibility -->
    <div class="status" id="statusMessage"></div>

    <section id="iosSection" class="section ios">
      <div class="section-header">
        <h2>iOS Permissions</h2>
      </div>
      <div class="toolbar">
        <input
          type="text"
          id="iosPermissionSearch"
          placeholder="Search iOS permissions or descriptions..."
        />
        <select id="iosCategoryFilter">
          <option value="">All categories</option>
        </select>
        <button
          id="addIosPermissionButton"
          type="button"
          class="btn-primary ios"
        >
          + Add Permission
        </button>
      </div>
      <div class="table-container">
        <table>
          <colgroup>
            <col style="width: 18%" />
            <col style="width: 32%" />
            <col style="width: 20%" />
            <col style="width: 15%" />
            <col style="width: 15%" />
          </colgroup>
          <thead>
            <tr>
              <th>Permission</th>
              <th>Value</th>
              <th>Description</th>
              <th>Category</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="iosPermissionTable"></tbody>
        </table>
      </div>
    </section>

    <section id="macosSection" class="section macos">
      <div class="section-header">
        <h2>macOS Permissions</h2>
      </div>
      <div class="toolbar">
        <input
          type="text"
          id="macosPermissionSearch"
          placeholder="Search macOS permissions or descriptions..."
        />
        <select id="macosCategoryFilter">
          <option value="">All categories</option>
        </select>
        <button
          id="addMacosPermissionButton"
          type="button"
          class="btn-primary macos"
        >
          + Add Permission
        </button>
      </div>
      <div class="table-container">
        <table>
          <colgroup>
            <col style="width: 18%" />
            <col style="width: 32%" />
            <col style="width: 20%" />
            <col style="width: 15%" />
            <col style="width: 15%" />
          </colgroup>
          <thead>
            <tr>
              <th>Permission</th>
              <th>Value</th>
              <th>Description</th>
              <th>Category</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="macosPermissionTable"></tbody>
        </table>
      </div>
    </section>

    <section class="section services">
      <div class="section-header">
        <h2>üîå Services</h2>
      </div>
      <div class="toolbar">
        <input
          type="text"
          id="serviceSearch"
          placeholder="Search configured services..."
        />
        <button id="addServiceButton" type="button" class="btn-primary">
          + Add Service
        </button>
      </div>
      <div id="servicesContainer" class="services-grid"></div>
    </section>

    <div class="modal-backdrop" id="serviceModalBackdrop" style="display: none">
      <div
        class="modal service-modal"
        role="dialog"
        aria-modal="true"
        aria-labelledby="serviceModalTitle"
      >
        <h3 id="serviceModalTitle">Configure Service</h3>
        <div id="serviceModalContent"></div>
        <div class="status" id="serviceModalError"></div>
        <div class="modal-actions">
          <button id="serviceModalCancel" type="button" class="btn-secondary">
            Cancel
          </button>
          <button id="serviceModalSave" type="button" class="btn-primary">
            Save Service
          </button>
        </div>
      </div>
    </div>

    <div
      class="modal-backdrop"
      id="addServiceModalBackdrop"
      style="display: none"
    >
      <div
        class="modal"
        role="dialog"
        aria-modal="true"
        aria-labelledby="addServiceModalTitle"
      >
        <h3 id="addServiceModalTitle">Add Service</h3>
        <p style="color: var(--text-secondary); margin: 0 0 16px">
          Select a service to configure:
        </p>
        <div id="addServiceList" class="service-list"></div>
        <div class="modal-actions">
          <button
            id="addServiceModalCancel"
            type="button"
            class="btn-secondary"
          >
            Cancel
          </button>
        </div>
      </div>
    </div>

    <div class="modal-backdrop" id="modalBackdrop">
      <div
        class="modal"
        role="dialog"
        aria-modal="true"
        aria-labelledby="modalTitle"
      >
        <h3 id="modalTitle">Add Permission</h3>
        <input
          type="text"
          id="modalSearch"
          placeholder="Search by permission, constant value, or category..."
        />
        <div id="modalCategoryTabs" class="category-tabs">
          <button class="category-tab active" data-category="">All</button>
        </div>
        <div class="modal-results" id="modalResults"></div>
        <div id="modalValueContainer" style="display: none; margin-top: 14px">
          <label
            for="modalValueInput"
            style="
              display: block;
              font-weight: 600;
              margin-bottom: 8px;
              color: var(--text-secondary);
              font-size: 12px;
              text-transform: uppercase;
              letter-spacing: 0.05em;
            "
            >Value</label
          >
          <input
            type="text"
            id="modalValueInput"
            placeholder="Enter usage description"
          />
          <select
            id="modalValueSelect"
            style="
              display: none;
              width: 100%;
              padding: 12px 14px;
              border: 1px solid var(--border-default);
              border-radius: var(--radius-md);
              background: var(--bg-tertiary);
              color: var(--text-primary);
              font-family: inherit;
            "
          >
            <option value="true">true</option>
            <option value="false">false</option>
          </select>
          <div
            class="status"
            id="modalValueHint"
            style="
              display: block;
              background: var(--ios-accent-dim);
              color: var(--ios-accent);
              border: 1px solid rgba(10, 132, 255, 0.3);
              margin-top: 8px;
            "
          >
            Provide a usage description required by Apple.
          </div>
        </div>
        <div class="status" id="modalError"></div>
        <div class="modal-actions">
          <button id="modalCancel" type="button" class="btn-secondary">
            Cancel
          </button>
          <button id="modalAdd" type="button" class="btn-primary">
            Add Permission
          </button>
        </div>
      </div>
    </div>

    <div
      class="modal-backdrop"
      id="crossPlatformModalBackdrop"
      style="display: none"
    >
      <div
        class="modal"
        role="dialog"
        aria-modal="true"
        aria-labelledby="crossPlatformModalTitle"
      >
        <h3 id="crossPlatformModalTitle">Add Cross-Platform Permissions</h3>
        <p
          id="crossPlatformModalMessage"
          style="color: var(--text-secondary); margin: 0 0 16px"
        >
          The permission you selected has equivalents on the other platform.
          Would you like to add them as well?
        </p>
        <div id="crossPlatformSuggestions"></div>
        <div class="status" id="crossPlatformModalError"></div>
        <div class="modal-actions">
          <button
            id="crossPlatformModalSkip"
            type="button"
            class="btn-secondary"
          >
            Skip
          </button>
          <button id="crossPlatformModalAdd" type="button" class="btn-primary">
            Add Selected
          </button>
        </div>
      </div>
    </div>

    <div
      class="modal-backdrop"
      id="equivalentModalBackdrop"
      style="display: none"
    >
      <div
        class="modal"
        role="dialog"
        aria-modal="true"
        aria-labelledby="equivalentModalTitle"
      >
        <h3 id="equivalentModalTitle">Add Equivalent Permissions</h3>
        <p
          id="equivalentModalMessage"
          style="color: var(--text-secondary); margin: 0 0 16px"
        >
          The following permissions are equivalent and can be added:
        </p>
        <div id="equivalentCategoryTabs" class="category-tabs"></div>
        <div
          id="equivalentSuggestions"
          style="max-height: 280px; overflow-y: auto"
        ></div>
        <div class="status" id="equivalentModalError"></div>
        <div class="modal-actions">
          <button
            id="equivalentModalCancel"
            type="button"
            class="btn-secondary"
          >
            Cancel
          </button>
          <button id="equivalentModalAdd" type="button" class="btn-primary">
            Add Selected
          </button>
        </div>
      </div>
    </div>

    <div class="modal-backdrop" id="syncModalBackdrop" style="display: none">
      <div
        class="modal"
        role="dialog"
        aria-modal="true"
        aria-labelledby="syncModalTitle"
      >
        <h3 id="syncModalTitle">Sync Equivalent Permissions</h3>
        <p
          id="syncModalMessage"
          style="color: var(--text-secondary); margin: 0 0 12px"
        >
          Select which equivalents to add. Provide iOS usage descriptions where
          required, then confirm to apply.
        </p>
        <div
          id="syncModalList"
          style="max-height: 320px; overflow-y: auto; margin-bottom: 12px"
        ></div>
        <div class="status" id="syncModalError"></div>
        <div class="modal-actions">
          <button id="syncModalCancel" type="button" class="btn-secondary">
            Cancel
          </button>
          <button id="syncModalConfirm" type="button" class="btn-primary">
            Confirm Sync
          </button>
        </div>
      </div>
    </div>

    <script src="{{utilsUri}}"></script>
    <script src="{{scriptUri}}"></script>
  </body>
</html>
